
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>OpenDP Proof Initiation &#8212; OpenDP</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=f91d6a3704ddd3a9dc0f" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=f91d6a3704ddd3a9dc0f" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=f91d6a3704ddd3a9dc0f" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=f91d6a3704ddd3a9dc0f" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=4f92a2c4" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=f91d6a3704ddd3a9dc0f" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=f91d6a3704ddd3a9dc0f" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=f91d6a3704ddd3a9dc0f"></script>

    <script src="../_static/documentation_options.js?v=9e420a66"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contributing/proof-initiation';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contribution Process" href="contribution-process.html" />
    <link rel="prev" title="OpenDP Rust Initiation" href="rust-initiation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Oct 11, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/opendp-logo.png" class="logo__image only-light" alt="OpenDP - Home"/>
    <script>document.write(`<img src="../_static/opendp-logo.png" class="logo__image only-dark" alt="OpenDP - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../getting-started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../theory/index.html">
                        Theory
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Contributing
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/opendp" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../getting-started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../theory/index.html">
                        Theory
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Contributing
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/opendp" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-involved.html">Getting Involved</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="development-environment.html">Development Environment</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="rust-initiation.html">OpenDP Rust Initiation</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">OpenDP Proof Initiation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="contribution-process.html">Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="cla.html">Contributor License Agreement</a></li>
</ul>
</div>
</nav></div>
        <div class="sidebar-primary-item">
<h6>Branches</h6>
<ul>
    <li><a href="../../beta/contributing/proof-initiation.html" style="font-weight: normal">beta</a></li>
    <li><a href="../../nightly/contributing/proof-initiation.html" style="font-weight: normal">nightly</a></li>
    <li><a href="../../stable/contributing/proof-initiation.html" style="font-weight: normal">stable</a></li>
</ul>


<h6 id="releases_header">Releases
    <div id="releases_symbol" style="float:right"></div>
</h6>
<ul id="releases_content">
    <li><a href="../../v0.14.1/contributing/proof-initiation.html" style="font-weight: normal">v0.14.1</a></li>
    <li><a href="proof-initiation.html" style="font-weight: bold">v0.14.0</a></li>
    <li><a href="../../v0.13.0/contributing/proof-initiation.html" style="font-weight: normal">v0.13.0</a></li>
    <li><a href="../../v0.12.1/contributing/proof-initiation.html" style="font-weight: normal">v0.12.1</a></li>
    <li><a href="../../v0.12.0/contributing/proof-initiation.html" style="font-weight: normal">v0.12.0</a></li>
    <li><a href="../../v0.11.1/contributing/proof-initiation.html" style="font-weight: normal">v0.11.1</a></li>
    <li><a href="../../v0.11.0/contributing/proof-initiation.html" style="font-weight: normal">v0.11.0</a></li>
    <li><a href="../../v0.10.0/index.html" style="font-weight: normal">v0.10.0</a></li>
    <li><a href="../../v0.9.2/index.html" style="font-weight: normal">v0.9.2</a></li>
    <li><a href="../../v0.9.1/index.html" style="font-weight: normal">v0.9.1</a></li>
    <li><a href="../../v0.9.0/index.html" style="font-weight: normal">v0.9.0</a></li>
    <li><a href="../../v0.8.0/index.html" style="font-weight: normal">v0.8.0</a></li>
    <li><a href="../../v0.7.0/index.html" style="font-weight: normal">v0.7.0</a></li>
    <li><a href="../../v0.6.2/index.html" style="font-weight: normal">v0.6.2</a></li>
    <li><a href="../../v0.6.1/index.html" style="font-weight: normal">v0.6.1</a></li>
    <li><a href="../../v0.6.0/index.html" style="font-weight: normal">v0.6.0</a></li>
    <li><a href="../../v0.5.0/index.html" style="font-weight: normal">v0.5.0</a></li>
    <li><a href="../../v0.4.0/index.html" style="font-weight: normal">v0.4.0</a></li>
    <li><a href="../../v0.3.0/index.html" style="font-weight: normal">v0.3.0</a></li>
    <li><a href="../../v0.2.4/index.html" style="font-weight: normal">v0.2.4</a></li>
    <li><a href="../../v0.2.3/index.html" style="font-weight: normal">v0.2.3</a></li>
    <li><a href="../../v0.2.2/index.html" style="font-weight: normal">v0.2.2</a></li>
    <li><a href="../../v0.2.1/index.html" style="font-weight: normal">v0.2.1</a></li>
    <li><a href="../../v0.2.0/index.html" style="font-weight: normal">v0.2.0</a></li>
    <li><a href="../../v0.1.0/index.html" style="font-weight: normal">v0.1.0</a></li>
</ul>
<script>
    let expanded = !!JSON.parse(localStorage.getItem('expanded'));

    let releasesHeader = document.getElementById("releases_header");
    let releasesSymbol = document.getElementById("releases_symbol");
    let releasesContent = document.getElementById("releases_content");

    function setReleasesState() {
        localStorage.setItem("expanded", JSON.stringify(expanded))
        releasesContent.style.display = expanded ? "block" : "none";
        releasesSymbol.classList.add(expanded ? 'minus' : 'plus')
        releasesSymbol.classList.remove(expanded ? 'plus' : 'minus')
    }

    setReleasesState()
    releasesHeader.addEventListener("click", function() {
        expanded = !expanded;
        setReleasesState()
    })
</script>
<style>
    .plus {
        position: relative;
        width:20px;
        height:20px;
        background:#676767;
    }

    .plus:before,
    .plus:after {
        content: "";
        position:absolute;
        background:#fff;
    }

    .plus:before {
        left:50%;
        top:4px;
        bottom:4px;
        width:3px;
        transform:translateX(-50%);
    }

    .plus:after {
        top:50%;
        left:4px;
        right:4px;
        height:3px;
        transform:translateY(-50%);
    }



    .minus {
        position: relative;
        width:20px;
        height:20px;
        background:#676767;
    }

    .minus:before,
    .minus:after {
        content: "";
        position:absolute;
        background:#fff;
    }

    .minus:after {
        top:50%;
        left:4px;
        right:4px;
        height:3px;
        transform:translateY(-50%);
    }
</style>
</div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Contributing</a></li>
    
    
    <li class="breadcrumb-item"><a href="development-environment.html" class="nav-link">Development Environment</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">OpenDP...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item"><div class="admonition warning" style="position: relative;">
    <!--
     Without the style, the region for the article title overlaps, and the link is unclickable.
    -->
    <details>
        <summary>Questions or feedback?</summary>
        <!--
            All of these lists should be in sync:
            - README.md
            - docs/source/contributing/contact.rst
            - docs/source/_templates/questions-feedback.html
            - .github/ISSUE_TEMPLATE/config.yml
        -->
        <ul>
            <li>Report a bug or request a feature on <a href="https://github.com/opendp/opendp/issues">Github</a>.</li>
            <li>Send general queries to <a href="mailto:info@opendp.org">info@opendp.org</a>, or email <a href="mailto:security@opendp.org">security@opendp.org</a> if it is related to security.</li>
            <li>Join the conversation on <a href="https://join.slack.com/t/opendp/shared_invite/zt-zw7o1k2s-dHg8NQE8WTfAGFnN_cwomA">Slack</a>, or the <a href="https://groups.google.com/a/g.harvard.edu/g/opendp-community">mailing list</a>.</li>
        </ul>
    </details>
</div></div>
      
        <div class="header-article-item">
<div class="admonition warning" style="position: relative;" id="old-version-warning">
  <!--
   To work with this locally, in conf.py uncomment the entry under "html_context".

   Without the style, the region for the article title overlaps, and the link is unclickable.
  -->
  <p class="admonition-title">
  
  This documentation is for an old version of OpenDP.
  
  </p>
  <p>The current release of OpenDP is <a href="/">v0.14.1</a>.</p>
</div>
<script>
  window.addEventListener("load", (event) => {
    document.getElementById('old-version-warning').style.top = `${window.visualViewport.pageTop}px`;
  });
</script>
</div>
      
    </div>
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="opendp-proof-initiation">
<h1>OpenDP Proof Initiation<a class="headerlink" href="#opendp-proof-initiation" title="Link to this heading">#</a></h1>
<p>This notebook is an introduction to writing proofs in the OpenDP
framework. It assumes you have already read about the <a class="reference internal" href="../api/user-guide/programming-framework/index.html#programming-framework"><span class="std std-ref">Programming Framework</span></a>,
and you have some familiarity with the library interfaces.</p>
<p>Our goal is to prove that OpenDP produces stable transformations and
private measurements. This requires a large body of proofs, as
constructor functions typically depend on other functions or traits that
themselves need to be proven.</p>
<section id="proof-structure">
<h2>Proof Structure<a class="headerlink" href="#proof-structure" title="Link to this heading">#</a></h2>
<p>Each document should at least have these components:</p>
<ol class="arabic simple">
<li><p>Hoare Triple</p>
<ol class="arabic simple">
<li><p>Precondition</p></li>
<li><p>Pseudocode</p></li>
<li><p>Postcondition</p></li>
</ol>
</li>
<li><p>Proof of postcondition, assuming precondition</p></li>
</ol>
<p>The precondition is a predicate function that captures any restrictions
on the set of valid inputs to the function. The (Python-esque)
pseudocode may exploit the restrictions on the inputs provided by the
precondition and make use of other functions or traits. The
postcondition is also a predicate function that sharply characterizes
the guarantees the function makes on the output.</p>
<p>This gets more involved for measurement and transformation constructor
functions. Constructor functions need to argue the correctness of the
stability map or privacy map, which refers to the behavior on a pair of
inputs. A LaTex macro is mentioned below that generates the expected
postconditions for transformation and measurement constructors.</p>
<p>The proof should show that, for any setting of the input arguments for
which the precondition is true, the postcondition is also true.</p>
</section>
<section id="function-example">
<h2>Function Example<a class="headerlink" href="#function-example" title="Link to this heading">#</a></h2>
<p>Let’s imagine we wanted to add a new function to
<code class="docutils literal notranslate"><span class="pre">rust/src/metrics/mod.rs</span></code> that computes the absolute distance:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="sd">/// # Proof Definition</span>
<span class="sd">/// For any setting of the input parameters,</span>
<span class="sd">/// returns either `Ok(out)` where $out \ge |a - b|$, or `Err(e)`.</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">absolute_distance</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="nc">InfSub</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">AlertingAbs</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="w"> </span><span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">:</span><span class="w"> </span><span class="nc">T</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Fallible</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">a</span><span class="p">.</span><span class="n">inf_sub</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="n">alerting_abs</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">inf_sub</span></code> is provided by the <code class="docutils literal notranslate"><span class="pre">InfSub</span></code> trait, and it computes the
subtraction of <code class="docutils literal notranslate"><span class="pre">b</span></code> from <code class="docutils literal notranslate"><span class="pre">a</span></code>. By the proof definition of <code class="docutils literal notranslate"><span class="pre">InfSub</span></code>,
if the outcome is not exactly representable in <code class="docutils literal notranslate"><span class="pre">T</span></code>, then the outcome
is rounded towards positive infinity, to the nearest value in <code class="docutils literal notranslate"><span class="pre">T</span></code>
(think of when <code class="docutils literal notranslate"><span class="pre">T</span></code> is float and arithmetic is not closed).</p>
<p>Again by the proof definition of <code class="docutils literal notranslate"><span class="pre">InfSub</span></code>, <code class="docutils literal notranslate"><span class="pre">inf_sub</span></code> returns an
error if the computation overflows. The type of things that <em>might</em> be
an error is <code class="docutils literal notranslate"><span class="pre">Fallible&lt;T&gt;</span></code>, which is an enum containing either
<code class="docutils literal notranslate"><span class="pre">Ok(value)</span></code>, where <code class="docutils literal notranslate"><span class="pre">value</span></code> is of type <code class="docutils literal notranslate"><span class="pre">T</span></code>, or <code class="docutils literal notranslate"><span class="pre">Err(e)</span></code>, where
<code class="docutils literal notranslate"><span class="pre">e</span></code> is the error details (backtrace, message, debug info).</p>
<p>Both <code class="docutils literal notranslate"><span class="pre">inf_sub</span></code> and <code class="docutils literal notranslate"><span class="pre">alerting_abs</span></code> return a value of type
<code class="docutils literal notranslate"><span class="pre">Fallible&lt;T&gt;</span></code>. After calling <code class="docutils literal notranslate"><span class="pre">inf_sub</span></code>, the question mark exits the
function early with the error, if there is one, otherwise execution
continues to <code class="docutils literal notranslate"><span class="pre">alerting_abs</span></code> with the value of type <code class="docutils literal notranslate"><span class="pre">T</span></code> stored inside
the <code class="docutils literal notranslate"><span class="pre">Ok</span></code> variant.</p>
<p>Notice that the function expects a return of type <code class="docutils literal notranslate"><span class="pre">Fallible&lt;T&gt;</span></code>. This
is consistent with the two return sites of the function: the question
mark after <code class="docutils literal notranslate"><span class="pre">inf_sub</span></code>, and the implicit return of the outcome of
<code class="docutils literal notranslate"><span class="pre">alerting_abs</span></code>.</p>
<p>When reading code in Rust for proof purposes, you can generally ignore
references (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>), dereferences (<code class="docutils literal notranslate"><span class="pre">*</span></code>, not multiplication) and clones
(<code class="docutils literal notranslate"><span class="pre">.clone()</span></code>). We consider these aspects of the code proven by the Rust
compiler.</p>
<section id="latex-template">
<h3>LaTex Template<a class="headerlink" href="#latex-template" title="Link to this heading">#</a></h3>
<p>To prove <code class="docutils literal notranslate"><span class="pre">fn</span> <span class="pre">absolute_distance</span></code>, we add a new file adjacent to the
function we want to prove, named after the function we want to prove:
<code class="docutils literal notranslate"><span class="pre">rust/src/metrics/absolute_distance.tex</span></code>.</p>
<p>Here’s a template for <code class="docutils literal notranslate"><span class="pre">absolute_distance.tex</span></code>:</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="k">\documentclass</span><span class="nb">{</span>article<span class="nb">}</span> <span class="c">% necessary for Overleaf to recognize the file</span>
<span class="k">\input</span><span class="nb">{</span>../lib.sty<span class="nb">}</span> <span class="c">% &quot;rust/src/lib.sty&quot; contains boilerplate and macros</span>

<span class="k">\title</span><span class="nb">{</span><span class="k">\texttt</span><span class="nb">{</span>fn absolute<span class="k">\_distance</span><span class="nb">}}</span>
<span class="k">\author</span><span class="nb">{</span>Your Name(s) Here<span class="nb">}</span><span class="k">\date</span><span class="nb">{}</span>

<span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>
<span class="k">\maketitle\contrib</span>
Proves soundness of <span class="k">\rustdoc</span><span class="nb">{</span>transformations/fn<span class="nb">}{</span>absolute<span class="k">\_distance</span><span class="nb">}</span> in <span class="k">\asOfCommit</span><span class="nb">{</span>mod.rs<span class="nb">}{</span>f5bb719<span class="nb">}</span>.

<span class="k">\subsection*</span><span class="nb">{</span>Vetting history<span class="nb">}</span>
<span class="k">\begin</span><span class="nb">{</span>itemize<span class="nb">}</span>
    <span class="k">\item</span> <span class="k">\vettingPR</span><span class="nb">{</span>519<span class="nb">}</span>
<span class="k">\end</span><span class="nb">{</span>itemize<span class="nb">}</span>

<span class="k">\section</span><span class="nb">{</span>Hoare Triple<span class="nb">}</span>
<span class="k">\subsection*</span><span class="nb">{</span>Preconditions<span class="nb">}</span>
<span class="k">\subsection*</span><span class="nb">{</span>Pseudocode<span class="nb">}</span>
<span class="k">\subsection*</span><span class="nb">{</span>Postcondition<span class="nb">}</span>

<span class="k">\section</span><span class="nb">{</span>Proof<span class="nb">}</span>

<span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</pre></div>
</div>
<p>This template uses several macros defined in <code class="docutils literal notranslate"><span class="pre">rust/src/lib.sty</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">\contrib</span></code> adds a header to the document indicating the proof is in
<code class="docutils literal notranslate"><span class="pre">&quot;contrib&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\rustdoc{path/to/fn}{ident}</span></code> creates a link to the rust
documentation for the function we are proving. When you build the
document, it should emit a link to the latest build of the docs on
docs.rs, <a class="reference external" href="https://docs.rs/opendp/latest/opendp/transformations/fn.absolute_distance.html">which may not exist
yet</a>.
When we cut a release, the <code class="docutils literal notranslate"><span class="pre">docs.rs</span></code> site is updated, and the links
in your document will be fixed to the released version of OpenDP. The
first argument to the macro is the subset of the path after
<code class="docutils literal notranslate"><span class="pre">opendp/</span></code>, up to the dot, and the second argument is the identifier
name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\asOfCommit{relative/path}{commit_hash}</span></code> is how you specify which
file you are proving, and the commit hash that last edited the file
you are proving. You can retrieve the hash with
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">--pretty=format:%h</span> <span class="pre">--</span> <span class="pre">path/to/file.rs</span></code>. If you are
proofwriting within the git repository, you can also find this hash
in the footnote. The resulting LaTex output is a permalink to the
file and an indicator on if the file has been updated since. This
makes is possible for proof documents to self-report when they go
out-of-date.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\vettingPR{PR_number}</span></code> is a simple macro to link a specific pull
request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\docsrs{crate}{path/to/fn}{ident}</span></code> is not used in this template.
It has a similar syntax to <code class="docutils literal notranslate"><span class="pre">\rustdoc</span></code>, but with an extra leading
argument to name a crate. It builds links to documentation in
external crates on <a class="reference external" href="https://docs.rs">docs.rs</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\validTransformation{input_arguments}{function_name}</span></code> is not used
in this template, but is useful when writing a proof for a
transformation constructor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\validMeasurement{input_arguments}{function_name}</span></code> same as above,
but for measurements.</p></li>
</ul>
<p>These macros are written such that your document will still compile
without <code class="docutils literal notranslate"><span class="pre">--shell-escape</span></code> enabled.</p>
<p>You can build this template with:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre data-tabindex="0"><span></span>pdflatex<span class="w"> </span>--synctex<span class="o">=</span><span class="m">1</span><span class="w"> </span>--interaction<span class="o">=</span>nonstopmode<span class="w"> </span>--file-line-error<span class="w"> </span>--aux-directory<span class="o">=</span>out<span class="w"> </span>--output-directory<span class="o">=</span>out<span class="w"> </span>--shell-escape<span class="w"> </span>absolute_distance.tex
</pre></div>
</div>
<p>If you use VSCode, the “Development Environment” documentation contains
some advice for integrating this with the LaTex-Workshop extension.</p>
<p>These options emit the build artifacts to ./out, which is configured to
be ignored by git. <strong>This is intentional, you should only include the</strong>
<code class="docutils literal notranslate"><span class="pre">.tex</span></code> <strong>file when committing to OpenDP!</strong> A bot will attempt to build
and link generated <code class="docutils literal notranslate"><span class="pre">.pdf</span></code> files from your PR.</p>
<p>We now continue by filling out the proof sections.</p>
</section>
<section id="preconditions">
<h3>Preconditions<a class="headerlink" href="#preconditions" title="Link to this heading">#</a></h3>
<p>The function we are proving has three input parameters, consisting of
one generic (<code class="docutils literal notranslate"><span class="pre">T</span></code>) and two arguments (<code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>), where the
arguments <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are of type <code class="docutils literal notranslate"><span class="pre">T</span></code>. One may call this function
with 32-bit signed integer arguments (<code class="docutils literal notranslate"><span class="pre">i32</span></code>):</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="n">absolute_distance</span><span class="p">(</span><span class="mi">1</span><span class="k">i32</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="k">i32</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the setting of the input parameters is
<code class="docutils literal notranslate"><span class="pre">(T=i32,</span> <span class="pre">a=1,</span> <span class="pre">b=2)</span></code>. The setting of <code class="docutils literal notranslate"><span class="pre">T</span></code> is inferred from the types
of the arguments.</p>
<p>The Rust syntax <code class="docutils literal notranslate"><span class="pre">T:</span> <span class="pre">InfSub</span> <span class="pre">+</span> <span class="pre">AlertingAbs</span></code> indicates that <code class="docutils literal notranslate"><span class="pre">T</span></code> is any
type for which the <code class="docutils literal notranslate"><span class="pre">InfSub</span></code> and <code class="docutils literal notranslate"><span class="pre">AlertingAbs</span></code> traits are
implemented. Thus, other valid types for <code class="docutils literal notranslate"><span class="pre">T</span></code> include the
single-precision float <code class="docutils literal notranslate"><span class="pre">f32</span></code>, unsigned 32-bit integer <code class="docutils literal notranslate"><span class="pre">u32</span></code>, as well
as other floats and integers with different bit depths. This may also
extend to fixed-point types, bignum integers and rationals.</p>
<p>Rust will only compile this code if the <code class="docutils literal notranslate"><span class="pre">InfSub</span></code> and <code class="docutils literal notranslate"><span class="pre">AlertingAbs</span></code>
traits have been implemented for <code class="docutils literal notranslate"><span class="pre">T</span></code>. These bounds on the type <code class="docutils literal notranslate"><span class="pre">T</span></code>
become part of the precondition for the function.</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="k">\subsection*</span><span class="nb">{</span>Preconditions<span class="nb">}</span>
<span class="k">\begin</span><span class="nb">{</span>itemize<span class="nb">}</span>
    <span class="k">\item</span> <span class="k">\texttt</span><span class="nb">{</span>T<span class="nb">}</span> is a type with traits <span class="k">\rustdoc</span><span class="nb">{</span>traits/trait<span class="nb">}{</span>InfSub<span class="nb">}</span> and <span class="k">\rustdoc</span><span class="nb">{</span>traits/trait<span class="nb">}{</span>AlertingAbs<span class="nb">}</span>.
<span class="k">\end</span><span class="nb">{</span>itemize<span class="nb">}</span>
</pre></div>
</div>
<p>In other contexts, it may make sense to specify preconditions on the
arguments as well.</p>
</section>
<section id="pseudocode">
<h3>Pseudocode<a class="headerlink" href="#pseudocode" title="Link to this heading">#</a></h3>
<p>The pseudocode should mimic the logic and usage of traits in the actual
rust code. The pseudocode isn’t strictly-defined, it is a tool to
communicate the algorithm in a way that is more accessible than Rust.</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="k">\section</span><span class="nb">{</span>Pseudocode<span class="nb">}</span>
<span class="k">\begin</span><span class="nb">{</span>lstlisting<span class="nb">}</span>[language = Python, escapechar=|]
def absolute<span class="nb">_</span>distance(a, b):
    a.inf<span class="nb">_</span>sub(b).alerting<span class="nb">_</span>abs() |<span class="k">\label</span><span class="nb">{</span>line:out<span class="nb">}</span>|
<span class="k">\end</span><span class="nb">{</span>lstlisting<span class="nb">}</span>
</pre></div>
</div>
<p>This code snip leverages the preconditions to make use of the
<code class="docutils literal notranslate"><span class="pre">inf_sub</span></code> method on <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
</section>
<section id="postcondition">
<h3>Postcondition<a class="headerlink" href="#postcondition" title="Link to this heading">#</a></h3>
<p>The postcondition is essentially the same as the proof definition on the
Rust code.</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre data-tabindex="0"><span></span>For any setting of the input parameters for which the precondition holds, <span class="k">\texttt</span><span class="nb">{</span>absolute<span class="nb">_</span>distance<span class="nb">}</span> returns either <span class="k">\texttt</span><span class="nb">{</span>Ok(out)<span class="nb">}</span> where <span class="s">$</span><span class="nb">out </span><span class="nv">\ge</span><span class="nb"> |a </span><span class="o">-</span><span class="nb"> b|</span><span class="s">$</span>, or <span class="k">\texttt</span><span class="nb">{</span>Err(e)<span class="nb">}</span>.
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(|a - b|\)</span> denotes an idealized quantity computed with infinite
precision.</p>
<p>Our goal is to use the pseudocode to prove that the postcondition is
always true when the precondition is true.</p>
</section>
<section id="proof">
<h3>Proof<a class="headerlink" href="#proof" title="Link to this heading">#</a></h3>
<p>Start by assuming the preconditions are met!</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="k">\section</span><span class="nb">{</span>Proof<span class="nb">}</span>
Assume the preconditions are met.
</pre></div>
</div>
<p>In order to use the properties guaranteed in the proof definition of
another function or trait, you must first prove that their preconditions
hold. <code class="docutils literal notranslate"><span class="pre">InfSub</span></code> and <code class="docutils literal notranslate"><span class="pre">AlertingAbs</span></code> don’t have any preconditions.</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre data-tabindex="0"><span></span>The preconditions for <span class="k">\texttt</span><span class="nb">{</span>InfSub<span class="nb">}</span> and <span class="k">\texttt</span><span class="nb">{</span>AlertingAbs<span class="nb">}</span> are trivially met.
</pre></div>
</div>
<p>We now use these definitions to prove the postcondition:</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="k">\begin</span><span class="nb">{</span>align*<span class="nb">}</span>
    <span class="k">\texttt</span><span class="nb">{</span>out<span class="nb">}</span>
    <span class="nb">&amp;</span>= a.inf<span class="nb">_</span>sub(b).alerting<span class="nb">_</span>abs() <span class="k">\\</span>
    <span class="nb">&amp;</span>= max(a.inf<span class="nb">_</span>sub(b), -a.inf<span class="nb">_</span>sub(b)) <span class="nb">&amp;&amp;</span> <span class="k">\text</span><span class="nb">{</span>by <span class="k">\texttt</span><span class="nb">{</span>AlertingAbs<span class="nb">}}</span> <span class="k">\\</span>
    <span class="nb">&amp;</span><span class="k">\ge</span> max(a - b, -a.inf<span class="nb">_</span>sub(b)) <span class="nb">&amp;&amp;</span> <span class="k">\text</span><span class="nb">{</span>by <span class="k">\texttt</span><span class="nb">{</span>InfSub<span class="nb">}}</span> <span class="k">\\</span>
<span class="k">\end</span><span class="nb">{</span>align*<span class="nb">}</span>
</pre></div>
</div>
<p>At this point, we get stuck. We can’t show the inequality we expected
because the code has a bug!</p>
<p>If the sign of the difference is negative, the round towards infinity is
a round towards zero, resulting in a smaller absolute distance than the
idealized absolute distance. This breaks the guarantee in our proof
definition. A bug like this could be abused by an adversary with a
sensitivity amplification widget; by carefully choosing constants that
exploit the gaps between floating-point numbers with large magnitudes.</p>
<p>This is why it is important to write proofs— it is easy to miss a detail
that can break privacy.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="rust-initiation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">OpenDP Rust Initiation</p>
      </div>
    </a>
    <a class="right-next"
       href="contribution-process.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Contribution Process</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-structure">Proof Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-example">Function Example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#latex-template">LaTex Template</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preconditions">Preconditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pseudocode">Pseudocode</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#postcondition">Postcondition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proof">Proof</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/contributing/proof-initiation.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=f91d6a3704ddd3a9dc0f"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=f91d6a3704ddd3a9dc0f"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.3rc1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>

<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Contingency Tables &#8212; OpenDP</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=f91d6a3704ddd3a9dc0f" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=f91d6a3704ddd3a9dc0f" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=f91d6a3704ddd3a9dc0f" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=f91d6a3704ddd3a9dc0f" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=4f92a2c4" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=f91d6a3704ddd3a9dc0f" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=f91d6a3704ddd3a9dc0f" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=f91d6a3704ddd3a9dc0f"></script>

    <script src="../../_static/documentation_options.js?v=818b74dc"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'getting-started/tabular-data/contingency-tables';</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Statistical Modeling" href="../statistical-modeling/index.html" />
    <link rel="prev" title="Preparing Microdata" href="preparing-microdata.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Feb 23, 2026"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>



<script>
document.write(`<aside class="bd-header-announcement" aria-label="Announcement"></aside>`);
fetch("https://raw.githubusercontent.com/opendp/opendp/refs/heads/main/docs/source/announcement.html")
  .then(res => {return res.text();})
  .then(data => {
    if (data.length === 0) {
      console.log("[PST]: Empty announcement at: https://raw.githubusercontent.com/opendp/opendp/refs/heads/main/docs/source/announcement.html");
      return;
    }
    div = document.querySelector(".bd-header-announcement");
    div.classList.add(...["bd-header-announcement", "container-fluid", "init"]);
    div.innerHTML = `<div class="bd-header-announcement__content">${data}</div>`;
    // At least 3rem height
    const autoHeight = Math.min(
      div.offsetHeight,
      3 * parseFloat(getComputedStyle(document.documentElement).fontSize));
    // Set height and vertical padding to 0 to prepare the height transition
    div.style.setProperty("height", 0);
    div.style.setProperty("padding-top", 0);
    div.style.setProperty("padding-bottom", 0);
    div.classList.remove("init");
    // Set height to the computed height with a small timeout to activate the transition
    setTimeout(() => {
      div.style.setProperty("height", `${autoHeight}px`);
      // Wait for a bit more than 300ms (the transition duration) then remove the
      // forcefully set styles and let CSS take over
      setTimeout(() => {
        div.style.removeProperty("padding-top");
        div.style.removeProperty("padding-bottom");
        div.style.removeProperty("height");
        div.style.setProperty("min-height", "3rem");
      }, 320);
    }, 10);
  })
  .catch(error => {
    console.log("[PST]: Failed to load announcement at: https://raw.githubusercontent.com/opendp/opendp/refs/heads/main/docs/source/announcement.html");
  });
</script>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/opendp-logo.png" class="logo__image only-light" alt="OpenDP - Home"/>
    <script>document.write(`<img src="../../_static/opendp-logo.png" class="logo__image only-dark" alt="OpenDP - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item pst-header-nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../../theory/index.html">
                        Theory
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../../contributing/index.html">
                        Contributing
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/opendp" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item pst-header-nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../../theory/index.html">
                        Theory
                      </a>
                    </li>
                

                    <li class="nav-item pst-header-nav-item ">
                      <a class="nav-link nav-internal" href="../../contributing/index.html">
                        Contributing
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/opendp" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typical-workflow.html">Typical Workflow</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Working with Tabular Data</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="essential-statistics.html">Essential Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="grouping.html">Grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="identifier-truncation.html">Identifier Truncation</a></li>
<li class="toctree-l2"><a class="reference internal" href="preparing-microdata.html">Preparing Microdata</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Contingency Tables</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../statistical-modeling/index.html">Statistical Modeling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../statistical-modeling/linear-regression.html">Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statistical-modeling/pca.html">Differentially Private PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../statistical-modeling/synthetic-data.html">Synthetic Data</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../utility.html">Assessing Utility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../next-steps.html">Next Steps</a></li>
</ul>
</div>
</nav></div>
        <div class="sidebar-primary-item">
<h6>Branches</h6>
<ul>
    <li><a href="../../../beta/getting-started/tabular-data/contingency-tables.html" style="font-weight: normal">beta</a></li>
    <li><a href="contingency-tables.html" style="font-weight: bold">nightly</a></li>
    <li><a href="../../../stable/getting-started/tabular-data/contingency-tables.html" style="font-weight: normal">stable</a></li>
</ul>


<h6 id="releases_header">Releases
    <div id="releases_symbol" style="float:right"></div>
</h6>
<ul id="releases_content">
    <li><a href="../../../v0.14.1/getting-started/tabular-data/contingency-tables.html" style="font-weight: normal">v0.14.1</a></li>
    <li><a href="../../../v0.14.0/getting-started/tabular-data/contingency-tables.html" style="font-weight: normal">v0.14.0</a></li>
    <li><a href="../../../v0.13.0/index.html" style="font-weight: normal">v0.13.0</a></li>
    <li><a href="../../../v0.12.1/index.html" style="font-weight: normal">v0.12.1</a></li>
    <li><a href="../../../v0.12.0/index.html" style="font-weight: normal">v0.12.0</a></li>
    <li><a href="../../../v0.11.1/index.html" style="font-weight: normal">v0.11.1</a></li>
    <li><a href="../../../v0.11.0/index.html" style="font-weight: normal">v0.11.0</a></li>
    <li><a href="../../../v0.10.0/index.html" style="font-weight: normal">v0.10.0</a></li>
    <li><a href="../../../v0.9.2/index.html" style="font-weight: normal">v0.9.2</a></li>
    <li><a href="../../../v0.9.1/index.html" style="font-weight: normal">v0.9.1</a></li>
    <li><a href="../../../v0.9.0/index.html" style="font-weight: normal">v0.9.0</a></li>
    <li><a href="../../../v0.8.0/index.html" style="font-weight: normal">v0.8.0</a></li>
    <li><a href="../../../v0.7.0/index.html" style="font-weight: normal">v0.7.0</a></li>
    <li><a href="../../../v0.6.2/index.html" style="font-weight: normal">v0.6.2</a></li>
    <li><a href="../../../v0.6.1/index.html" style="font-weight: normal">v0.6.1</a></li>
    <li><a href="../../../v0.6.0/index.html" style="font-weight: normal">v0.6.0</a></li>
    <li><a href="../../../v0.5.0/index.html" style="font-weight: normal">v0.5.0</a></li>
    <li><a href="../../../v0.4.0/index.html" style="font-weight: normal">v0.4.0</a></li>
    <li><a href="../../../v0.3.0/index.html" style="font-weight: normal">v0.3.0</a></li>
    <li><a href="../../../v0.2.4/index.html" style="font-weight: normal">v0.2.4</a></li>
    <li><a href="../../../v0.2.3/index.html" style="font-weight: normal">v0.2.3</a></li>
    <li><a href="../../../v0.2.2/index.html" style="font-weight: normal">v0.2.2</a></li>
    <li><a href="../../../v0.2.1/index.html" style="font-weight: normal">v0.2.1</a></li>
    <li><a href="../../../v0.2.0/index.html" style="font-weight: normal">v0.2.0</a></li>
    <li><a href="../../../v0.1.0/index.html" style="font-weight: normal">v0.1.0</a></li>
</ul>
<script>
    let expanded = !!JSON.parse(localStorage.getItem('expanded'));

    let releasesHeader = document.getElementById("releases_header");
    let releasesSymbol = document.getElementById("releases_symbol");
    let releasesContent = document.getElementById("releases_content");

    function setReleasesState() {
        localStorage.setItem("expanded", JSON.stringify(expanded))
        releasesContent.style.display = expanded ? "block" : "none";
        releasesSymbol.classList.add(expanded ? 'minus' : 'plus')
        releasesSymbol.classList.remove(expanded ? 'plus' : 'minus')
    }

    setReleasesState()
    releasesHeader.addEventListener("click", function() {
        expanded = !expanded;
        setReleasesState()
    })
</script>
<style>
    .plus {
        position: relative;
        width:20px;
        height:20px;
        background:#676767;
    }

    .plus:before,
    .plus:after {
        content: "";
        position:absolute;
        background:#fff;
    }

    .plus:before {
        left:50%;
        top:4px;
        bottom:4px;
        width:3px;
        transform:translateX(-50%);
    }

    .plus:after {
        top:50%;
        left:4px;
        right:4px;
        height:3px;
        transform:translateY(-50%);
    }



    .minus {
        position: relative;
        width:20px;
        height:20px;
        background:#676767;
    }

    .minus:before,
    .minus:after {
        content: "";
        position:absolute;
        background:#fff;
    }

    .minus:after {
        top:50%;
        left:4px;
        right:4px;
        height:3px;
        transform:translateY(-50%);
    }
</style>
</div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Getting Started</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Working with Tabular Data</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Contingency Tables</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item"><div class="admonition warning" style="position: relative;">
    <!--
     Without the style, the region for the article title overlaps, and the link is unclickable.
    -->
    <details>
        <summary>Questions or feedback?</summary>
        <!--
            All of these lists should be in sync:
            - README.md
            - docs/source/contributing/contact.rst
            - docs/source/_templates/questions-feedback.html
            - .github/ISSUE_TEMPLATE/config.yml
        -->
        <ul>
            <li>Report a bug or request a feature on <a href="https://github.com/opendp/opendp/issues">Github</a>.</li>
            <li>Send general queries to <a href="mailto:info@opendp.org">info@opendp.org</a>, or email <a href="mailto:security@opendp.org">security@opendp.org</a> if it is related to security.</li>
            <li>Join the conversation on <a href="https://join.slack.com/t/opendp/shared_invite/zt-1t8rrbqhd-z8LiZiP06vVE422HJd6ciQ">Slack</a>, or the <a href="https://groups.google.com/a/g.harvard.edu/g/opendp-community">mailing list</a>.</li>
        </ul>
    </details>
</div></div>
      
        <div class="header-article-item">
<div class="admonition warning" style="position: relative;" id="old-version-warning">
  <!--
   To work with this locally, in conf.py uncomment the entry under "html_context".

   Without the style, the region for the article title overlaps, and the link is unclickable.
  -->
  <p class="admonition-title">
  
  This documentation is for a development version of OpenDP.
  
  </p>
  <p>The current release of OpenDP is <a href="/">v0.14.1</a>.</p>
</div>
<script>
  window.addEventListener("load", (event) => {
    document.getElementById('old-version-warning').style.top = `${window.visualViewport.pageTop}px`;
  });
</script>
</div>
      
    </div>
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="contingency-tables">
<span id="id1"></span><h1>Contingency Tables<a class="headerlink" href="#contingency-tables" title="Link to this heading">#</a></h1>
<p>A <em>contingency table</em> counts the number of records in each group, when grouping by the columns in a dataset.
Contingency tables capture the relationships between columns in your data.</p>
<p>As the number of columns in the contingency table grows,
the number of possible combinations of keys (AKA groups) increases exponentially quickly.
This results in the contingency table becoming too large to hold in memory or measure with any utility.
For this reason, it is recommended to instead estimate specific relationships between smaller sets of two or maybe three columns
by releasing <em>marginals</em> (counts when data is grouped by some subset of the columns).</p>
<p>Unlike releasing these grouped counts separately, with marginals the results will be internally consistent.
This makes them a good basis for hierarchical queries.</p>
<p>OpenDP uses <a class="reference external" href="https://private-pgm.readthedocs.io/en/latest/introduction.html">Private-PGM</a>
to build a contingency table that is consistent with a set of marginal queries via a process called model-based inference (<code class="docutils literal notranslate"><span class="pre">mbi</span></code>).
This functionality is not enabled by default.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="python" for="sd-tab-item-0">
Python</label><div class="sd-tab-content docutils">
<p>Add <code class="docutils literal notranslate"><span class="pre">[mbi]</span></code> to the package installation to enable model-based-inference functionality.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1">pip<span class="w"> </span>install<span class="w"> </span><span class="s1">&#39;opendp[mbi]&#39;</span></span>
</pre></div></div><p>This installs the specific version of the Private-PGM package that is compatible with the OpenDP Library.</p>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="r" for="sd-tab-item-1">
R</label><div class="sd-tab-content docutils">
<p><code class="docutils literal notranslate"><span class="pre">mbi</span></code> (Private-PGM) is only available in Python.</p>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="rust" for="sd-tab-item-2">
Rust</label><div class="sd-tab-content docutils">
<p><code class="docutils literal notranslate"><span class="pre">mbi</span></code> (Private-PGM) is only available in Python.</p>
</div>
</div>
<p>Let’s get started by setting up the context for the Labor Force dataset.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">opendp.prelude</span> <span class="k">as</span> <span class="nn">dp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dp</span><span class="o">.</span><span class="n">enable_features</span><span class="p">(</span><span class="s2">&quot;contrib&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">Context</span><span class="o">.</span><span class="n">compositor</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">scan_csv</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">dp</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">get_france_lfs_path</span><span class="p">(),</span>
<span class="gp">... </span>        <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span>    <span class="n">privacy_unit</span><span class="o">=</span><span class="n">dp</span><span class="o">.</span><span class="n">unit_of</span><span class="p">(</span><span class="n">contributions</span><span class="o">=</span><span class="mi">36</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">privacy_loss</span><span class="o">=</span><span class="n">dp</span><span class="o">.</span><span class="n">loss_of</span><span class="p">(</span><span class="n">rho</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.contingency_table</span></code> releases an approximation to a contingency table over all columns
by estimating lower order marginals.
To improve the utility of the mechanism,
specify the key-sets for categorical data, and cut-sets for numerical data.
The mechanism will release stable keys for any columns that don’t have key- or cut-sets.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">context</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">rho</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># transformations/truncation may be applied here</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;SEX&quot;</span><span class="p">,</span> <span class="s2">&quot;AGE&quot;</span><span class="p">,</span> <span class="s2">&quot;HWUSUAL&quot;</span><span class="p">,</span> <span class="s2">&quot;ILOSTAT&quot;</span>
<span class="gp">... </span>    <span class="p">)</span><span class="o">.</span><span class="n">contingency_table</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">keys</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;SEX&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
<span class="gp">... </span>        <span class="n">cuts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;AGE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="s2">&quot;HWUSUAL&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">]},</span>
<span class="gp">... </span>        <span class="n">algorithm</span><span class="o">=</span><span class="n">dp</span><span class="o">.</span><span class="n">mbi</span><span class="o">.</span><span class="n">Fixed</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">queries</span><span class="o">=</span><span class="p">[</span>
<span class="gp">... </span>                <span class="n">dp</span><span class="o">.</span><span class="n">mbi</span><span class="o">.</span><span class="n">Count</span><span class="p">((</span><span class="s2">&quot;AGE&quot;</span><span class="p">,</span> <span class="s2">&quot;HWUSUAL&quot;</span><span class="p">)),</span>
<span class="gp">... </span>                <span class="n">dp</span><span class="o">.</span><span class="n">mbi</span><span class="o">.</span><span class="n">Count</span><span class="p">((</span><span class="s2">&quot;HWUSUAL&quot;</span><span class="p">,</span> <span class="s2">&quot;ILOSTAT&quot;</span><span class="p">)),</span>
<span class="gp">... </span>            <span class="p">],</span>
<span class="gp">... </span>            <span class="c1"># proportion of budget to spend estimating one-way marginal key-sets</span>
<span class="gp">... </span>            <span class="c1">#   (defaults to num_unknown / num_columns / 2)</span>
<span class="gp">... </span>            <span class="n">oneway_split</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">),</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>By default, up to half of the privacy budget is used to estimate one-way marginals and their keys.
The privacy budget used depends on the proportion of columns with unknown keys or cuts.
For example, in the prior query, keys are specified for all columns except <code class="docutils literal notranslate"><span class="pre">ILOSTAT</span></code>,
so an eighth of the budget is used to estimate a one-way marginal on <code class="docutils literal notranslate"><span class="pre">ILOSTAT</span></code>.
You can configure the privacy budget split for one-way marginals and key release
via the <code class="docutils literal notranslate"><span class="pre">oneway_split</span></code> attribute on the algorithm.</p>
<p>Before releasing, you can view the noise scale and threshold to be used when estimating one-way key-sets.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">query</span><span class="o">.</span><span class="n">oneway_scale</span>
<span class="go">227.68399153212334</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span><span class="o">.</span><span class="n">oneway_threshold</span>
<span class="go">1364</span>
</pre></div>
</div>
<p>In this setting, the scale and threshold are reasonably small.
To make the threshold smaller, consider adding more key-sets
or bounding the number of groups a user may contribute.</p>
<p>When you release, all marginals are estimated and stored inside a <a class="reference internal" href="../../api/python/opendp.extras.mbi.html#opendp.extras.mbi.ContingencyTable" title="opendp.extras.mbi.ContingencyTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContingencyTable</span></code></a>.
The contingency table supports counting queries over arbitrary sets of grouping columns.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="p">:</span> <span class="n">dp</span><span class="o">.</span><span class="n">mbi</span><span class="o">.</span><span class="n">ContingencyTable</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</pre></div>
</div>
<p>Any keys in the data that are not present in the key-set,
either because they are missing from the key-set (like a third category for <code class="docutils literal notranslate"><span class="pre">SEX</span></code>)
or because they had frequencies too low to meet the threshold (like the uncommon <code class="docutils literal notranslate"><span class="pre">ILOSTAT</span></code> category <code class="docutils literal notranslate"><span class="pre">5</span></code>),
are replaced with <code class="docutils literal notranslate"><span class="pre">null</span></code> when estimating higher-order marginals.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">keys</span><span class="p">[</span><span class="s2">&quot;ILOSTAT&quot;</span><span class="p">]</span>  
<span class="go">shape: (5,)</span>
<span class="go">Series: &#39;ILOSTAT&#39; [i64]</span>
<span class="go">[</span>
<span class="go">    1</span>
<span class="go">    2</span>
<span class="go">    3</span>
<span class="go">    9</span>
<span class="go">    null</span>
<span class="go">]</span>
</pre></div>
</div>
<p>In this example, infrequent <code class="docutils literal notranslate"><span class="pre">ILOSTAT</span></code> categories of <code class="docutils literal notranslate"><span class="pre">4</span></code> and <code class="docutils literal notranslate"><span class="pre">5</span></code> were absorbed into the <code class="docutils literal notranslate"><span class="pre">null</span></code> key.
Preserve true nulls in your data by preprocessing them into another key via <code class="docutils literal notranslate"><span class="pre">.select</span></code> or <code class="docutils literal notranslate"><span class="pre">.with_columns</span></code>.</p>
<p>To see counts of the number of records corresponding to each key,
project the contingency table down to just <code class="docutils literal notranslate"><span class="pre">ILOSTAT</span></code>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">project</span><span class="p">((</span><span class="s2">&quot;ILOSTAT&quot;</span><span class="p">,))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>  
<span class="go">Array([1515729,  155912, 1450748,  689452,     109], dtype=int64)</span>
</pre></div>
</div>
<p>The same projection can be viewed in a melted dataframe form:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">project_melted</span><span class="p">((</span><span class="s2">&quot;ILOSTAT&quot;</span><span class="p">,))</span>  
<span class="go">shape: (5, 2)</span>
<span class="go">┌─────────┬──────────────┐</span>
<span class="go">│ ILOSTAT ┆ len          │</span>
<span class="go">│ ---     ┆ ---          │</span>
<span class="go">│ i64     ┆ f64          │</span>
<span class="go">╞═════════╪══════════════╡</span>
<span class="go">│ 1       ┆ 1.5157e6     │</span>
<span class="go">│ 2       ┆ 156011.15206 │</span>
<span class="go">│ 3       ┆ 1.4509e6     │</span>
<span class="go">│ 9       ┆ 689551.39267 │</span>
<span class="go">│ null    ┆ 119.022842   │</span>
<span class="go">└─────────┴──────────────┘</span>
</pre></div>
</div>
<p>Since <code class="docutils literal notranslate"><span class="pre">(&quot;ILOSTAT&quot;,)</span></code> is covered by the query workload,
an estimate of the standard deviation can be derived.
Since all noise added is gaussian-distributed,
the resulting noise distribution remains approximately gaussian-distributed,
so it is possible to construct a confidence interval for each scalar in the projection.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">std</span><span class="p">((</span><span class="s2">&quot;ILOSTAT&quot;</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp</span><span class="o">.</span><span class="n">gaussian_scale_to_accuracy</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="go">446.2524232592843</span>
</pre></div>
</div>
<p>That is, the true count differs from the estimate by no more than the accuracy estimate,
with <code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">-</span> <span class="pre">alpha)100%</span></code> confidence.</p>
<section id="adaptive-estimation">
<h2>Adaptive Estimation<a class="headerlink" href="#adaptive-estimation" title="Link to this heading">#</a></h2>
<p>Now consider the <code class="docutils literal notranslate"><span class="pre">SEX</span></code> column, which contains three keys:
the two specified in <code class="docutils literal notranslate"><span class="pre">keys</span></code>, as well as <code class="docutils literal notranslate"><span class="pre">null</span></code> for any records not in the key set.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">keys</span><span class="p">[</span><span class="s2">&quot;SEX&quot;</span><span class="p">]</span>  
<span class="go">shape: (3,)</span>
<span class="go">Series: &#39;SEX&#39; [i64]</span>
<span class="go">[</span>
<span class="go">    1</span>
<span class="go">    2</span>
<span class="go">    null</span>
<span class="go">]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SEX</span></code> is not well-supported by the contingency table,
because it is not included in any of the released marginals.
As a result, the best estimate for the total number of records is distributed uniformly over the key set,
and the standard deviation is unknown.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">project</span><span class="p">((</span><span class="s2">&quot;SEX&quot;</span><span class="p">,))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>  
<span class="go">Array([1270561, 1270561, 1270561], dtype=int64)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">std</span><span class="p">((</span><span class="s2">&quot;SEX&quot;</span><span class="p">,))</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">attrs ((&#39;SEX&#39;,)) are not covered by the query set</span>
</pre></div>
</div>
<p>To improve the utility of this projection, you could release an updated contingency table with more marginals.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span> <span class="o">=</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">context</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">rho</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SEX&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">contingency_table</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">algorithm</span><span class="o">=</span><span class="n">dp</span><span class="o">.</span><span class="n">mbi</span><span class="o">.</span><span class="n">Fixed</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">queries</span><span class="o">=</span><span class="p">[</span><span class="n">dp</span><span class="o">.</span><span class="n">mbi</span><span class="o">.</span><span class="n">Count</span><span class="p">((</span><span class="s2">&quot;SEX&quot;</span><span class="p">,))]</span>
<span class="gp">... </span>        <span class="p">),</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">release</span><span class="p">()</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>The updated table now much more accurately reflects the distribution of counts over <code class="docutils literal notranslate"><span class="pre">SEX</span></code>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre data-tabindex="0"><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span><span class="o">.</span><span class="n">project</span><span class="p">((</span><span class="s2">&quot;SEX&quot;</span><span class="p">,))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>  
<span class="go">Array([1828251, 1982295,    1228], dtype=int64)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span><span class="o">.</span><span class="n">std</span><span class="p">((</span><span class="s2">&quot;SEX&quot;</span><span class="p">,))</span>
<span class="go">113.84199576606166</span>
</pre></div>
</div>
<p>The contingency table mechanism can satisfy either pure-DP (epsilon) or zCDP (rho).
If approximate-DP (delta) is not enabled, then the key-set and cut-set must be exhaustive.
Since microdata is never materialized outside of Polars,
datasets can be as large in size as can be handled by the Polars library.</p>
<p>The sensitivity of marginals released by the mechanism are derived in the same fashion as any other OpenDP Polars marginal query,
meaning they benefit from bounds on user contribution defined in the privacy unit or acquired through identifier truncation.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="preparing-microdata.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Preparing Microdata</p>
      </div>
    </a>
    <a class="right-next"
       href="../statistical-modeling/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Statistical Modeling</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-estimation">Adaptive Estimation</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/getting-started/tabular-data/contingency-tables.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=f91d6a3704ddd3a9dc0f"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=f91d6a3704ddd3a9dc0f"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.3rc1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>